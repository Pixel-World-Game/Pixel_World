<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836" data-dLayer-ignore="true" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() {}</script><script>window.dataLayer = window.dataLayer || []; dataLayer.push({ event: 'dataLayer-initialized', user: { user_unity_id: undefined, user_logged_in: 'no' }, environment: { environment_locale: 'en-us', environment_currency: undefined }});</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Create and run a job</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=20241003"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=20241003"></script><script type="text/javascript" src="docdata/toc.js?ts=20241003"></script><script type="text/javascript" src="docdata/global_toc.js?ts=20241003"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=20241003">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2022.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/JobSystemCreatingJobs.html">English</a></li>
<li><a href="/cn/current/Manual/JobSystemCreatingJobs.html">中文</a></li>
<li><a href="/ja/current/Manual/JobSystemCreatingJobs.html">日本語</a></li>
<li><a href="/kr/current/Manual/JobSystemCreatingJobs.html">한국어</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2022.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/JobSystemCreatingJobs.html">English</a></li>
<li><a href="/cn/current/Manual/JobSystemCreatingJobs.html">中文</a></li>
<li><a href="/ja/current/Manual/JobSystemCreatingJobs.html">日本語</a></li>
<li><a href="/kr/current/Manual/JobSystemCreatingJobs.html">한국어</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="ScriptingSection.html">Scripting</a></li>
<li><a href="JobSystem.html">Job system </a></li>
<li>Create and run a job</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="job-system-custom-nativecontainer-example.html"></a></span><div class="tip">Custom NativeContainer example</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="JobSystemJobDependencies.html"></a></span><div class="tip">Job dependencies </div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>Create and run a job</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>To create and successfully run a job, you must do the following:</p>

<ul>
<li>Create a job: Implement the <a href="../ScriptReference/Unity.Jobs.IJob.html"><code>IJob</code></a> interface.</li>
<li>Schedule the job: Call the <a href="../ScriptReference/Unity.Jobs.IJobExtensions.Schedule.html"><code>Schedule</code></a> method on the job.</li>
<li>Wait for the job to complete: It returns immediately if the job is already complete, and you can call the <a href="../ScriptReference/Unity.Jobs.JobHandle.Complete.html"><code>Complete</code></a> method on the job when you want to access the data.</li>
</ul>

<h2>Create a job</h2>

<p>To create a job in Unity, implement the <a href="../ScriptReference/Unity.Jobs.IJob.html"><code>IJob</code></a> interface. You can use your <code>IJob</code> implementation to schedule a single job that runs in parallel to any other jobs that are running.</p>

<p>
<code>IJob</code> has one required method: <a href="../ScriptReference/Unity.Jobs.IJob.Execute.html"><code>Execute</code></a>, which Unity invokes whenever a <a href="JobSystemOverview.html#multithreading">worker thread</a> runs the job.</p>

<p>When you create a job, you can also create a <a href="../ScriptReference/Unity.Jobs.JobHandle.html"><code>JobHandle</code></a> for it, which other methods need to use to reference the job.</p>

<p>
<strong>Important:</strong> There’s no protection against accessing non-readonly or <span class="tooltip"><strong>mutable</strong><span class="tooltiptext">You can change the contents of a mutable package. This is the opposite of <strong>immutable</strong>. Only <strong>Local package</strong><strong>s</strong> and <strong>Embedded package</strong><strong>s</strong> are mutable.<br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Mutable">Glossary</a></span></span></span> static data from within a job. Accessing this kind of data circumvents all safety systems and might crash your application or the Unity Editor.</p>

<p>When Unity runs, the job system makes a copy of scheduled job data, which prevents more than one thread from reading or writing the same data. Only data written to a <code>NativeContainer</code> can be accessed after the job finishes. This is because both the copy of the <code>NativeContainer</code> that the job uses and the original <code>NativeContainer</code> object point to the same memory. For more information, see the documentation on <a href="JobSystemNativeContainer.html">Thread safe types</a>.</p>

<p>When the job system picks up a job from its job queue, it runs the <code>Execute</code> method once on a single thread. Typically, the job system runs jobs on background threads, but it can choose the main thread if it becomes idle. For this reason, you should design your jobs to complete in under a frame.</p>

<p><a name="schedule-a-job"></a></p>

<h2>Schedule a job</h2>

<p>To schedule a job, call <code>Schedule</code>. This puts the job into the job queue, and the job system begins executing the job once all its <a href="JobSystemJobDependencies.html">dependencies</a>, if any, complete. Once scheduled, you can’t interrupt a job. You can only call <code>Schedule</code> from the main thread.</p>

<p>
<strong>Tip:</strong> Jobs have a <a href="../ScriptReference/Unity.Jobs.IJobExtensions.Run.html"><code>Run</code></a> method that you can use in place of <code>Schedule</code> to immediately execute the job on the main thread. You can use this for debugging purposes.</p>

<h2>Complete the job</h2>

<p>Once you call <code>Schedule</code> and the job system has executed a job, you can call the <a href="../ScriptReference/Unity.Jobs.JobHandle.Complete.html"><code>Complete</code></a> method on the <code>JobHandle</code> to access the data in the job. It’s best practice to call <code>Complete</code> as late as possible in your code. When you call <code>Complete</code>, the main thread can safely access the <a href="JobSystemNativeContainer.html"><code>NativeContainer</code></a> instance that the job was using. Calling <code>Complete</code> also cleans up the state in the safety system. Not doing so introduces a memory leak.</p>

<h2>Job examples</h2>

<p>The following is an example of a job that adds two floating point values together. It implements <a href="../ScriptReference/Unity.Jobs.IJob.html"><code>IJob</code></a>, uses a <code>NativeArray</code> to get the results of the job, and uses the <a href="../ScriptReference/Unity.Jobs.IJob.Execute.html"><code>Execute</code></a> method with the implementation of the job inside it:</p>

<pre><code class="lang-cs">using UnityEngine;
using Unity.Collections;
using Unity.Jobs;

// Job adding two floating point values together
public struct MyJob : IJob
{
    public float a;
    public float b;
    public NativeArray&lt;float&gt; result;

    public void Execute()
    {
        result[0] = a + b;
    }
}
</code></pre>

<p>The following example builds on the <code>MyJob</code> job to schedule a job on the main thread:</p>

<pre><code class="lang-cs">using UnityEngine;
using Unity.Collections;
using Unity.Jobs;

public class MyScheduledJob : MonoBehaviour
{
    // Create a native array of a single float to store the result. Using a 
    // NativeArray is the only way you can get the results of the job, whether
    // you're getting one value or an array of values.
    NativeArray&lt;float&gt; result;
    // Create a JobHandle for the job
    JobHandle handle;

    // Set up the job
    public struct MyJob : IJob
    {
        public float a;
        public float b;
        public NativeArray&lt;float&gt; result;

        public void Execute()
        {
            result[0] = a + b;
        }
    }

    // Update is called once per frame
    void Update()
    {
        // Set up the job data
        result = new NativeArray&lt;float&gt;(1, Allocator.TempJob);

        MyJob jobData = new MyJob
        {
            a = 10,
            b = 10,
            result = result
        };

        // Schedule the job
        handle = jobData.Schedule();
    }

    private void LateUpdate()
    {
        // Sometime later in the frame, wait for the job to complete before accessing the results.
        handle.Complete();

        // All copies of the NativeArray point to the same memory, you can access the result in &quot;your&quot; copy of the NativeArray
        // float aPlusB = result[0];

        // Free the memory allocated by the result array
        result.Dispose();
    }


}
</code></pre>

<h2>Schedule and Complete best practices</h2>

<p>It’s best practice to call <code>Schedule</code> on a job as soon as you have the data it needs, and don’t call <code>Complete</code> on it until you need the results.</p>

<p>You can schedule less important jobs in a part of the frame where they aren’t competing with more important jobs. </p>

<p>For example, if there is a period between the end of one frame and the beginning of the next frame where no jobs are running, and a one frame latency is acceptable, you can schedule the job towards the end of a frame and use its results in the following frame. Alternatively, if your application saturates that changeover period with other jobs, and there’s an under-utilized period somewhere else in the frame, it’s more efficient to schedule your job there instead.</p>

<p>You can also use the <span class="tooltip"><a class="tooltipMoreInfoLink" href="Profiler.html">Profiler</a><span class="tooltiptext">A window that helps you to optimize your game. It shows how much time is spent in the various areas of your game. For example, it can report the percentage of time spent rendering, animating, or in your game logic. <a href="Profiler.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Profiler">Glossary</a></span></span></span> to see where Unity is waiting for jobs to complete. The marker <code>WaitForJobGroupID</code> on the main thread indicates this. This marker might mean that you’ve introduced a data dependency somewhere that you should resolve. Look for <code>JobHandle.Complete</code> to track down where you have data dependencies that are forcing the main thread to wait.</p>

<h3>Avoid using long running jobs</h3>

<p>Unlike threads, jobs don’t yield execution. Once a job starts, that job worker thread commits to completing the job before running any other job. As such, it’s best practice to break up long running jobs into smaller jobs that <a href="JobSystemJobDependencies.html">depend on one another</a>, instead of submitting jobs that take a long time to complete relative to other jobs in the system. </p>

<p>The job system usually runs multiple chains of job dependencies, so if you break up long running tasks into multiple pieces there is a chance for multiple job chains to progress. If instead the job system is filled with long running jobs, they might completely consume all worker threads and block independent jobs from executing. This might push out the completion time of important jobs that the main thread explicitly waits for, resulting in stalls on the main thread that otherwise wouldn’t exist. </p>

<p>In particular, long running <a href="../ScriptReference/Unity.Jobs.IJobParallelFor.html"><code>IJobParallelFor</code></a> jobs impact negatively on the job system because these job types intentionally try to run on as many worker threads as possible for the job batch size. If you can’t break up long parallel jobs, consider increasing the batch size of your job when scheduling it to limit how many workers pick up the long running job.</p>

<pre><code class="lang-csharp">MyParallelJob jobData = new MyParallelJob();
jobData.Data = someData;  
jobData.Result = someArray;  
// Use half the available worker threads, clamped to a minimum of 1 worker thread
const int numBatches = Math.Max(1, JobsUtility.JobWorkerCount / 2); 
const int totalItems = someArray.Length;
const int batchSize = totalItems / numBatches;
// Schedule the job with one Execute per index in the results array and batchSize items per processing batch
JobHandle handle = jobData.Schedule(result.Length, totalItems, batchSize);
</code></pre>

<h2>Additional resources</h2>

<ul>
<li><a href="JobSystemJobDependencies.html">Job dependencies</a></li>
<li><a href="JobSystemNativeContainer.html">Thread safe types</a></li>
</ul>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="job-system-custom-nativecontainer-example.html"></a></span><div class="tip">Custom NativeContainer example</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="JobSystemJobDependencies.html"></a></span><div class="tip">Job dependencies </div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2024 Unity Technologies. Publication Date: 2024-10-03.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a><a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a><a href="https://unity.com/legal">Legal</a><a href="https://unity.com/legal/privacy-policy">Privacy Policy</a><a href="https://unity.com/legal/cookie-policy">Cookies</a><a href="https://unity.com/legal/do-not-sell-my-personal-information">Do Not Sell or Share My Personal Information</a><div id="ot-sdk-btn-container"><a id="ot-sdk-btn" class="ot-sdk-show-settings" href="javascript:void(0);">Your Privacy Choices (Cookie Settings)</a></div>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
