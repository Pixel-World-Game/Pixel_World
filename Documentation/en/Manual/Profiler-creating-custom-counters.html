<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836" data-dLayer-ignore="true" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() {}</script><script>window.dataLayer = window.dataLayer || []; dataLayer.push({ event: 'dataLayer-initialized', user: { user_unity_id: undefined, user_logged_in: 'no' }, environment: { environment_locale: 'en-us', environment_currency: undefined }});</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Creating custom Profiler counters</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=20241003"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=20241003"></script><script type="text/javascript" src="docdata/toc.js?ts=20241003"></script><script type="text/javascript" src="docdata/global_toc.js?ts=20241003"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=20241003">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2022.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/Profiler-creating-custom-counters.html">English</a></li>
<li><a href="/cn/current/Manual/Profiler-creating-custom-counters.html">中文</a></li>
<li><a href="/ja/current/Manual/Profiler-creating-custom-counters.html">日本語</a></li>
<li><a href="/kr/current/Manual/Profiler-creating-custom-counters.html">한국어</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2022.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/Profiler-creating-custom-counters.html">English</a></li>
<li><a href="/cn/current/Manual/Profiler-creating-custom-counters.html">中文</a></li>
<li><a href="/ja/current/Manual/Profiler-creating-custom-counters.html">日本語</a></li>
<li><a href="/kr/current/Manual/Profiler-creating-custom-counters.html">한국어</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityOverview.html">Working in Unity</a></li>
<li><a href="analysis.html">Analysis</a></li>
<li><a href="Profiler.html">Profiler overview</a></li>
<li><a href="Profiler-customizing.html">Customizing the Profiler</a></li>
<li>Creating custom Profiler counters</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="Profiler-customizing.html"></a></span><div class="tip">Customizing the Profiler</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="Profiler-creating-custom-modules.html"></a></span><div class="tip">Creating Custom Profiler modules</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>Creating custom Profiler counters</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>To display custom metrics in the Unity <span class="tooltip"><strong>profiler</strong><span class="tooltiptext">A window that helps you to optimize your game. It shows how much time is spent in the various areas of your game. For example, it can report the percentage of time spent rendering, animating, or in your game logic. <a class="tooltipMoreInfoLink" href="Profiler.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Profiler">Glossary</a></span></span></span>, you must use the ProfilerCounter API in the <a href="https://docs.unity3d.com/Packages/com.unity.profiling.core@latest?subfolder=/manual/index.html">Unity Profiling Core</a> package.</p>

<p>You can use the Profiling Core API to track a metric in your application. You can display the information that a counter tracks in the Unity Profiler. Use custom <span class="tooltip"><strong>Profiler counters</strong><span class="tooltiptext">Placed in code with the ProfilerCounter API to track metrics, such as the number of enemies spawned in your game. <a class="tooltipMoreInfoLink" href="https://docs.unity3d.com/Packages/com.unity.profiling.core@latest/index.html?subfolder=/manual/profilercounter-guide.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Profilercounter">Glossary</a></span></span></span> to compare system metrics and identify performance issues in the Profiler window.</p>

<p>A custom Profiler counter can display data from <code>ProfilerCounter</code> or <code>ProfilerCounterValue</code>. </p>

<p>For a complete guide to using the Unity Profiling Core API to create Profiler counters, see the <a href="https://docs.unity3d.com/Packages/com.unity.profiling.core@latest?subfolder=/manual/profilercounter-guide.html">Profiler counters API guide</a>.</p>

<p>To add a profiler counter, create <span class="tooltip"><strong>scripts</strong><span class="tooltiptext">A piece of code that allows you to create your own Components, trigger game events, modify Component properties over time and respond to user input in any way you like. <a class="tooltipMoreInfoLink" href="CreatingAndUsingScripts.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scripts">Glossary</a></span></span></span> to do the following:</p>

<ul>
<li>
<a href="#define-counter">Create a new counter</a>.</li>
<li>Assign your counter to a <span class="tooltip"><a href="#using-profiler-categories">Profiler category</a><span class="tooltiptext">Identifies the workload data for a Unity subsystem (for example, Rendering, Scripting and Animation categories). Unity applies color-coding to categories to visually distinguish between the types of data in the <strong>Profiler</strong> window.<br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Profilercategory">Glossary</a></span></span></span>.</li>
<li>
<a href="#update-counter-value">Update the counter’s value</a>.</li>
</ul>

<p>The code examples in these sections add a Profiler counter to track the total number of particles that Unity created for every instance of a <span class="tooltip"><strong>GameObject</strong><span class="tooltiptext">The fundamental object in Unity scenes, which can represent characters, props, scenery, cameras, waypoints, and more. A GameObject’s functionality is defined by the Components attached to it. <a class="tooltipMoreInfoLink" href="class-GameObject.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#GameObject">Glossary</a></span></span></span>’s trail effects. In these examples, the GameObject’s name is “Tank”.</p>

<p><a name="define-counter"></a></p>

<h2>Defining a counter</h2>

<p>To create a new counter, write a script to define the value type of the new counter, and assign a name and a unit to this type.</p>

<p>When you create a counter you must specify which <a href="../ScriptReference/Unity.Profiling.ProfilerCategory.html">Profiler category</a> your new counter belongs to. To do this use an existing Unity category. For example, the script example below uses the existing <code>ProfilerCategory.Scripts</code> category.For more information, see <a href="#using-profiler-categories">Using Profiler categories</a>
</p>

<p>The following example script defines the <a href="https://docs.unity3d.com/Packages/com.unity.profiling.core@latest?subfolder=/api/Unity.Profiling.ProfilerCounter-1.html">ProfilerCounterValue</a> <code>TankTrailParticleCount</code>, with the name “Tank Trail Particles”. This counter has a unit of “Count”:</p>

<pre><code class="lang-csharp"> 
 public static class GameStats
 {
    public static readonly ProfilerCategory TanksCategory = ProfilerCategory.Scripts;

    public const string TankTrailParticleCountName = &quot;Tank Trail Particles&quot;;
    public static readonly ProfilerCounterValue&lt;int&gt; TankTrailParticleCount =
        new ProfilerCounterValue&lt;int&gt;(TanksCategory, TankTrailParticleCountName, ProfilerMarkerDataUnit.Count,
            ProfilerCounterOptions.FlushOnEndOfFrame | ProfilerCounterOptions.ResetToZeroOnFlush);
}
</code></pre>

<p>The options <code>FlushOnEndOfFrame</code> and <code>ResetToZeroOnFlush</code> automatically send the counter to the Profiler data stream and reset the Count value to zero at the end of the frame.</p>

<p><a name="using-profiler-categories"></a></p>

<h2>Using Profiler categories</h2>

<p>Unity automatically groups Profiler counters into categories based on the type of work the counters profile, for example, Rendering, Scripting, or Animation. You can assign a custom Profiler counter to any of Unity’s profiling categories. For a full list of available Profiler categories, see <a href="../ScriptReference/Unity.Profiling.ProfilerCategory.html">ProfilerCategory</a>. </p>

<h3>Assigning a Profiler counter to a Profiler category</h3>

<p>A Profiler counter must belong to a Profiler category. You should assign a category to a Profiler counter when you define the counter. To do this, use the ProfilerModule’s optional <code>autoEnabledCategoryNames</code> constructor argument to assign one or more categories to a Profiler counter. There is an example of this method in the following example code:</p>

<pre><code class="lang-csharp">
 using Unity.Profiling;
 using Unity.Profiling.Editor;

 [System.Serializable]
 [ProfilerModuleMetadata(&quot;Tank Effects&quot;)] 
 public class TankEffectsProfilerModule : ProfilerModule
 {
    static readonly ProfilerCounterDescriptor[] k_Counters = new ProfilerCounterDescriptor[]
    {
        new ProfilerCounterDescriptor(GameStatistics.TankTrailParticleCountName, GameStatistics.TanksCategory),
        new ProfilerCounterDescriptor(GameStatistics.ShellExplosionParticleCountName, GameStatistics.TanksCategory),
        new ProfilerCounterDescriptor(GameStatistics.TankExplosionParticleCountName, GameStatistics.TanksCategory),
    };

    // Ensure that both ProfilerCategory.Scripts and ProfilerCategory.Memory categories are enabled when our module is active.
    static readonly string[] k_AutoEnabledCategoryNames = new string[]
    {
        ProfilerCategory.Scripts.Name,
        ProfilerCategory.Memory.Name
    };


    // Pass the auto-enabled category names to the base constructor.
    public TankEffectsProfilerModule() : base(k_Counters, autoEnabledCategoryNames: k_AutoEnabledCategoryNames) { }
}
</code></pre>

<p><a name="update-counter-value"></a></p>

<h2>Updating a counter’s value</h2>

<p>To update the value of a counter, create a MonoBehaviour script that sets the value of a counter you have defined. For more information, see <a href="https://docs.unity3d.com/Packages/com.unity.profiling.core@latest?subfolder=/manual/profilercounter-guide.html#how-to-pass-counter-values-to-the-profiler">How to pass counter values to the Profiler</a>.</p>

<h3>Updating the counter’s value script example</h3>

<p>This example MonoBehaviour script counts the number of trail particles that belong to an assigned GameObject every frame in the Update function. To do this, it uses the counter called <code>TankTrailParticleCount</code>.</p>

<p>The following example script also creates a public property called <strong>Trail <span class="tooltip"><strong>Particle System</strong><span class="tooltiptext">A component that simulates fluid entities such as liquids, clouds and flames by generating and animating large numbers of small 2D images in the scene. <a class="tooltipMoreInfoLink" href="class-ParticleSystem.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a class="tooltipMoreInfoLink" href="Glossary.html#particlesystem">Glossary</a></span></span></span></strong> (<code>m_TrailParticleSystem</code>) in the <span class="tooltip"><strong>Inspector</strong><span class="tooltiptext">A Unity window that displays information about the currently selected GameObject, asset or project settings, allowing you to inspect and edit the values. <a href="UsingTheInspector.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Inspector">Glossary</a></span></span></span>:</p>

<pre><code class="lang-csharp">
 using UnityEngine;

 class TankMovement : MonoBehaviour
 {
    public ParticleSystem m_TrailParticleSystem;

    void Update()
    {
        GameStats.TankTrailParticleCount.Value += m_TrailParticleSystem.particleCount;
    }
 }
</code></pre>

<figure>
<img src="../uploads/Main/Profiler_Tank_example.png" alt="">
</figure>

<p><a name="release-build-counters"></a></p>

<h2>Using Profiler counters to profile a release build</h2>

<p>When you run your project in a release player, you don’t have access to the Profiler window. However, you can display counters as <span class="tooltip"><strong>UI</strong><span class="tooltiptext">(User Interface) Allows a user to interact with your application. Unity currently supports three UI systems. <a class="tooltipMoreInfoLink" href="UI-system-compare.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#UI">Glossary</a></span></span></span> elements in a release player. This means you can include profiling tools in a released application. To do this, see <strong>Getting counter values in players</strong> in the <a href="https://docs.unity3d.com/Packages/com.unity.profiling.core@latest?subfolder=/manual/profilercounter-guide.html">Profiler counters API guide</a>.</p>

<p>The following image displays counters in the top left of the <span class="tooltip"><strong>scene</strong><span class="tooltiptext">A Scene contains the environments and menus of your game. Think of each unique Scene file as a unique level. In each Scene, you place your environments, obstacles, and decorations, essentially designing and building your game in pieces. <a class="tooltipMoreInfoLink" href="CreatingScenes.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scene">Glossary</a></span></span></span> using custom UI in a release player:</p>

<figure>
<img src="../uploads/Main/Tanks-Runtime-Stats.png" alt="">
</figure>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="Profiler-customizing.html"></a></span><div class="tip">Customizing the Profiler</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="Profiler-creating-custom-modules.html"></a></span><div class="tip">Creating Custom Profiler modules</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2024 Unity Technologies. Publication Date: 2024-10-03.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a><a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a><a href="https://unity.com/legal">Legal</a><a href="https://unity.com/legal/privacy-policy">Privacy Policy</a><a href="https://unity.com/legal/cookie-policy">Cookies</a><a href="https://unity.com/legal/do-not-sell-my-personal-information">Do Not Sell or Share My Personal Information</a><div id="ot-sdk-btn-container"><a id="ot-sdk-btn" class="ot-sdk-show-settings" href="javascript:void(0);">Your Privacy Choices (Cookie Settings)</a></div>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
