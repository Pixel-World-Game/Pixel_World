<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836" data-dLayer-ignore="true" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() {}</script><script>window.dataLayer = window.dataLayer || []; dataLayer.push({ event: 'dataLayer-initialized', user: { user_unity_id: undefined, user_logged_in: 'no' }, environment: { environment_locale: 'en-us', environment_currency: undefined }});</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Use `PropertyVisitor` to create a property visitor</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=20241003"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=20241003"></script><script type="text/javascript" src="docdata/toc.js?ts=20241003"></script><script type="text/javascript" src="docdata/global_toc.js?ts=20241003"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=20241003">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2022.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/property-visitors-PropertyVisitor.html">English</a></li>
<li><a href="/cn/current/Manual/property-visitors-PropertyVisitor.html">中文</a></li>
<li><a href="/ja/current/Manual/property-visitors-PropertyVisitor.html">日本語</a></li>
<li><a href="/kr/current/Manual/property-visitors-PropertyVisitor.html">한국어</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2022.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/property-visitors-PropertyVisitor.html">English</a></li>
<li><a href="/cn/current/Manual/property-visitors-PropertyVisitor.html">中文</a></li>
<li><a href="/ja/current/Manual/property-visitors-PropertyVisitor.html">日本語</a></li>
<li><a href="/kr/current/Manual/property-visitors-PropertyVisitor.html">한국어</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="ScriptingSection.html">Scripting</a></li>
<li><a href="properties.html">Unity Properties</a></li>
<li>Use `PropertyVisitor` to create a property visitor</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="property-paths.html"></a></span><div class="tip">Property paths</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="property-visitors-low-level-api.html"></a></span><div class="tip">Use low-level APIs to create a property visitor</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>Use <code>PropertyVisitor</code> to create a property visitor</h1>

<p>This example demonstrates how to use the <a href="../ScriptReference/Unity.Properties.PropertyVisitor.html"><code>PropertyVisitor</code></a> base class to create a property visitor. For an equivalent example that uses the <a href="../ScriptReference/Unity.Properties.IPropertyBagVisitor.html"><code>IPropertyBagVisitor</code></a> and <a href="../ScriptReference/Unity.Properties.IPropertyVisitor.html"><code>IPropertyVisitor</code></a> interfaces, refer to <a href="property-visitors-low-level-api.html">Use low-level APIs to create a property visitor</a>.</p>

<h2>Example overview</h2>

<p>This example includes step-by-step instructions to create a property visitor that prints the current state of an object to the console. </p>

<p>Assume you have the following type:</p>

<pre><code class="lang-csharp">public class Data
{
    public string Name = &quot;Henry&quot;;
    public Vector2 Vec2 = Vector2.one;
    public List&lt;Color&gt; Colors = new List&lt;Color&gt; { Color.green, Color.red };
    public Dictionary&lt;int, string&gt; Dict = new Dictionary&lt;int, string&gt; {{5, &quot;zero&quot;}};
}
</code></pre>

<p>Create a utility method <code>DebugUtilities</code> like this:</p>

<pre><code class="lang-csharp">public static class DebugUtilities
{
    public static void PrintObjectDump&lt;T&gt;(T value)
    {
        // Magic goes here.
    }
}
</code></pre>

<p>Call the <code>PrintObjectDump</code> method with the <code>Data</code> object like this:</p>

<pre><code class="lang-csharp">DebugUtilities.PrintObjectDump(new Data());
</code></pre>

<p><a name="desired-output"></a></p>

<p>Would print the following to the console:</p>

<pre><code class="lang-text">- Name {string} = Henry
- Vec2 {Vector2} = (1.00, 1.00)
- Colors {List&lt;Color&gt;}
  - [0] = {Color} RGBA(0.000, 1.000, 0.000, 1.000)
  - [1] = {Color} RGBA(1.000, 0.000, 0.000, 1.000)
- Dict {Dictionary&lt;int, string&gt;}
  - [5] {KeyValuePair&lt;int, string&gt;}
    - Key {int} = 5
    - Value {string} = five
</code></pre>

<h2>Create the visitor</h2>

<p>First, create a <code>DumpObjectVisitor</code> class. Inside the class, use a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.text.stringbuilder?view=net-7.0">StringBuilder</a> to build a string that represents the current state of an object.</p>

<ol>
<li><p>Create a <code>DumpObjectVisitor</code> class that inherits from <a href="../ScriptReference/Unity.Properties.PropertyVisitor.html"><code>PropertyVisitor</code></a>.</p></li>
<li><p>Add a <code>StringBuilder</code> field to the class.</p></li>
<li><p>Add a <code>Reset</code> method that clears the <code>StringBuilder</code> and resets the indent level.</p></li>
<li>
<p>Add a <code>GetDump</code> method that returns the string representation of the current state of an object.</p>

<p>Your finished class looks like this:</p>

<pre><code class="lang-csharp">// `PropertyVisitor` is an abstract class that you must subclass from it. 
public class DumpObjectVisitor: PropertyVisitor
{
    private const int k_InitialIndent = 0;
    private readonly StringBuilder m_Builder = new StringBuilder();
        
    private int m_IndentLevel = k_InitialIndent;
        
    private string Indent =&gt; new (' ', m_IndentLevel * 2);
        
    public void Reset()
    {
        m_Builder.Clear();
        m_IndentLevel = k_InitialIndent;
    }

    public string GetDump()
    {
        return m_Builder.ToString();
    }
}
</code></pre>
</li>
</ol>

<h2>Get the top-level properties</h2>

<p>Inside the <code>DumpObjectVisitor</code> class, override the <a href="../ScriptReference/Unity.Properties.PropertyVisitor.VisitProperty.html"><code>VisitProperty</code></a> method to visit each property of an object and log the property name. The <a href="../ScriptReference/Unity.Properties.PropertyVisitor.html"><code>PropertyVisitor</code></a> doesn’t require any members to implement and by default, it simply visits every property and performs no action.</p>

<ol>
<li>
<p>Inside the <code>DumpObjectVisitor</code> class, add the following override <code>VisitProperty</code> method:</p>

<pre><code class="lang-csharp">protected override void VisitProperty&lt;TContainer, TValue&gt;(Property&lt;TContainer, TValue&gt; property, ref TContainer container, ref TValue value)
{
    m_Builder.AppendLine($&quot;- {property.Name}&quot;);
}
</code></pre>
</li>
<li>
<p>Now that you have a minimal visitor, you can implement the utility method. Update the <code>PrintObjectDump</code> method in the <code>DebugUtilities</code> class to create a new <code>DumpObjectVisitor</code> instance and use it to visit the properties of the given object:</p>

<pre><code class="lang-csharp">public static class DebugUtilities
{
    private static readonly DumpObjectVisitor s_Visitor = new ();
        
    public static void PrintObjectDump&lt;T&gt;(T value)
    {
        s_Visitor.Reset();
            
        // This is the main entry point to run a visitor.
        PropertyContainer.Accept(s_Visitor, ref value);
        Debug.Log(s_Visitor.GetDump());
    }
}
</code></pre>

<p>This gets the following output:</p>

<pre><code class="lang-text">- Name
- Vec2
- Colors
- Dict
</code></pre>
</li>
</ol>

<h2>Get the sub-properties</h2>

<p>The output from the previous section indicates that when you override the <a href="../ScriptReference/Unity.Properties.PropertyVisitor.VisitProperty.html"><code>VisitProperty</code></a> method, it doesn’t automatically visit the sub-properties of an object. To get the sub-properties, use the <a href="../ScriptReference/Unity.Properties.PropertyContainer.Accept.html"><code>PropertyContainer.Accept</code></a> method to apply the visitor on each of the values recursively.</p>

<ul>
<li>
<p>Inside the <code>DebugUtilities</code> class, update the <code>VisitProperty</code> method to apply the visitor recursively on the value to nest in:</p>

<pre><code class="lang-csharp">protected override void VisitProperty&lt;TContainer, TValue&gt;(Property&lt;TContainer, TValue&gt; property, ref TContainer container, ref TValue value)
{
    m_Builder.AppendLine($&quot;{Indent}- {property.Name}&quot;);
        
    ++m_IdentLevel;
    // Apply this visitor recursively on the value to nest in.
    if (null != value)
        PropertyContainer.Accept(this, ref value);
    --m_IdentLevel;
}
</code></pre>

<p>This gets the following output:</p>

<pre><code class="lang-text">- Name
- Vec2
- x
- y
- Colors
- 0
    - r
    - g
    - b
    - a
- 1
    - r
    - g
    - b
    - a 
- Dict
- 5
    - Key
    - Value
</code></pre>
</li>
</ul>

<h2>Display more details about each property</h2>

<p>Next, let’s get the property name of collection items, and the type and value of each property.</p>

<p>Certain properties have special names, especially when dealing with collection items. Here are the conventions for property names:</p>

<ul>
<li>For list items, the name corresponds to the index.</li>
<li>For dictionaries, the name is derived from the string version of the key value.</li>
<li>For sets, the name is based on the string version of the value.</li>
</ul>

<p>To make this distinction more explicit, encase the property name with square brackets.</p>

<ol>
<li>
<p>Inside the <code>DumpObjectVisitor</code> class, add the following method:</p>

<pre><code class="lang-csharp">private static string GetPropertyName(IProperty property)
{
    return property switch
    {
        // You can also treat `IListElementProperty`, `IDictionaryElementProperty`, and `ISetElementProperty` separately.
        ICollectionElementProperty =&gt; $&quot;[{property.Name}]&quot;,
        _ =&gt; property.Name
    };
}
</code></pre>
</li>
<li>
<p>Update the <code>VisitProperty</code> method to use <a href="../ScriptReference/Unity.Properties.TypeUtility.GetTypeDisplayName.html"><code>TypeUtility.GetTypeDisplayName</code></a> to retrieve the display name of a given type. </p>

<pre><code class="lang-csharp">protected override void VisitProperty&lt;TContainer, TValue&gt;(Property&lt;TContainer, TValue&gt; property, ref TContainer container, ref TValue value)
{
    var propertyName = GetPropertyName(property);
        
    // Get the concrete type of the property or its declared type if value is null.
    var typeName = TypeUtility.GetTypeDisplayName(value?.GetType() ?? property.DeclaredValueType());
        
    m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{typeName}}} {value}&quot;);
        
    ++m_IndentLevel;
    if (null != value)
        PropertyContainer.Accept(this, ref value);
    --m_IndentLevel;
}
</code></pre>

<p>This gets the following output:</p>

<pre><code class="lang-text">- Name = {string} Henry
- Vec2 = {Vector2} (1.00, 1.00)
- x = {float} 1
- y = {float} 1
- Colors = {List&lt;Color&gt;} System.Collections.Generic.List`1[UnityEngine.Color]
- [1] = {Color} RGBA(0.000, 1.000, 0.000, 1.000)
    - r = {float} 0
    - g = {float} 1
    - b = {float} 0
    - a = {float} 1
- [1] = {Color} RGBA(1.000, 0.000, 0.000, 1.000)
    - r = {float} 1
    - g = {float} 0
    - b = {float} 0
    - a = {float} 1
- Dict = {Dictionary&lt;int, string&gt;} System.Collections.Generic.Dictionary`2[System.Int32,System.String]
- [5] = {KeyValuePair&lt;int, string&gt;} [5, five]
    - Key = {int} 5
    - Value = {string} five
</code></pre>
</li>
</ol>

<h2>Reduce the amount of information displayed for collection types</h2>

<p>Because <code>List&lt;T&gt;</code> doesn’t override the <code>ToString()</code> method, the list value is displayed as <code>System.Collections.Generic.List1[UnityEngine.Color]</code>. To reduce the amount of information displayed, update the <code>VisitProperty</code> to use the <a href="../ScriptReference/Unity.Properties.TypeTraits.IsContainer.html"><code>TypeTraits.IsContainer</code></a> utility method to only display the value for types that don’t contain sub-properties, such as primitives, enums and strings.</p>

<p>Inside the <code>DumpObjectVisitor</code> class, update the <code>VisitProperty</code> method to use <a href="../ScriptReference/Unity.Properties.TypeTraits.IsContainer.html"><code>TypeTraits.IsContainer</code></a> to determine whether the value is a container type. If it is, display the type name without the value. Otherwise, display the type name and the value.</p>

<pre><code class="lang-csharp">protected override void VisitProperty&lt;TContainer, TValue&gt;(Property&lt;TContainer, TValue&gt; property, ref TContainer container, ref TValue value)
{
    var propertyName = GetPropertyName(property);

    var type = value?.GetType() ?? property.DeclaredValueType();
    var typeName = TypeUtility.GetTypeDisplayName(type);
    
    // Only display the values for primitives, enums and strings.
    if (TypeTraits.IsContainer(type))
        m_Builder.AppendLine($&quot;{Indent}- {propertyName} {{{typeName}}}&quot;);
    else
        m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{typeName}}} {value}&quot;);
    
    ++m_IndentLevel;
    if (null != value)
        PropertyContainer.Accept(this, ref value);
    --m_IndentLevel;
}
</code></pre>

<p>This gets the following output:</p>

<pre><code class="lang-text">- Name = {string} Henry
- Vec2 {Vector2}
- x = {float} 1
- y = {float} 1
- Colors {List&lt;Color&gt;}
- [0] {Color}
    - r = {float} 0
    - g = {float} 1
    - b = {float} 0
    - a = {float} 1
- [1] {Color}
    - r = {float} 1
    - g = {float} 0
    - b = {float} 0
    - a = {float} 1
- Dict {Dictionary&lt;int, string&gt;}
- [5] {KeyValuePair&lt;int, string&gt;}
    - Key = {int} 5
    - Value = {string} five
</code></pre>

<p>
<strong>Tip</strong>:</p>

<p>To reduce the amount of information displayed, you can also use the following methods to override a <code>Visit</code> specialization for the collection types:</p>

<pre><code class="lang-csharp">protected override void VisitCollection&lt;TContainer, TCollection, TElement&gt;(Property&lt;TContainer, TCollection&gt; property, ref TContainer container, ref TCollection value) {}
protected override void VisitList&lt;TContainer, TList, TElement&gt;(Property&lt;TContainer, TList&gt; property, ref TContainer container, ref TList value) {}
protected override void VisitDictionary&lt;TContainer, TDictionary, TKey, TValue&gt;(Property&lt;TContainer, TDictionary&gt; property, ref TContainer container, ref TDictionary value) {}
protected override void VisitSet&lt;TContainer, TSet, TValue&gt;(Property&lt;TContainer, TSet&gt; property, ref TContainer container, ref TSet value) {}
</code></pre>

<p>These are similar to the <a href="../ScriptReference/Unity.Properties.PropertyVisitor.VisitProperty.html"><code>VisitProperty</code></a> method, but they expose the generic parameters of their respective collections types.</p>

<h2>Add per-type overrides</h2>

<p>Lastly, add per-type overrides to display <a href="../ScriptReference/UnityEngine.Vector2.html"><code>Vector2</code></a> and <a href="../ScriptReference/UnityEngine.Color.html"><code>Color</code></a> types in a more compact manner. </p>

<p>Use <a href="../ScriptReference/Unity.Properties.PropertyVisitor.html"><code>PropertyVisitor</code></a> along with <a href="../ScriptReference/Unity.Properties.IVisitPropertyAdapter.html"><code>IVisitPropertyAdapter</code></a>. Whenever an adapter is registered for a given type, if the targeted type is encountered during the visitation, the adapter is called instead of the <a href="../ScriptReference/Unity.Properties.PropertyVisitor.VisitProperty.html"><code>VisitProperty</code></a> method:</p>

<p>Inside the <code>DumpObjectVisitor</code> class, add the <code>IVisitPropertyAdapter</code> for <code>Vector2</code> and <code>Color</code>:</p>

<pre><code class="lang-csharp">public class DumpObjectVisitor
    : PropertyVisitor
    , IVisitPropertyAdapter&lt;Vector2&gt;
    , IVisitPropertyAdapter&lt;Color&gt;
{
    public DumpObjectVisitor()
    {
        AddAdapter(this);
    }
    
    void IVisitPropertyAdapter&lt;Vector2&gt;.Visit&lt;TContainer&gt;(in VisitContext&lt;TContainer, Vector2&gt; context, ref TContainer container, ref Vector2 value)
    {
        var propertyName = GetPropertyName(context.Property);
        m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{nameof(Vector2)}}} {value}&quot;);
    }

    void IVisitPropertyAdapter&lt;Color&gt;.Visit&lt;TContainer&gt;(in VisitContext&lt;TContainer, Color&gt; context, ref TContainer container, ref Color value)
    {
        var propertyName = GetPropertyName(context.Property);
        m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{nameof(Color)}}} {value}&quot;);
    }
}
</code></pre>

<p>The completed <code>DumpObjectVisitor</code> class looks like this:</p>

<pre><code class="lang-csharp">public class DumpObjectVisitor
: PropertyVisitor
, IVisitPropertyAdapter&lt;Vector2&gt;
, IVisitPropertyAdapter&lt;Color&gt; 
{
    private const int k_InitialIndent = 0;
    
    // StringBuilder to store the dumped object's properties and values.
    private readonly StringBuilder m_Builder = new StringBuilder();
    private int m_IndentLevel = k_InitialIndent;
    
    // Helper property to get the current indentation.
    private string Indent =&gt; new (' ', m_IndentLevel * 2);

    public DumpObjectVisitor()
    {
        // Constructor, it initializes the DumpObjectVisitor and adds itself as an adapter
        // to handle properties of type Vector2 and Color.
        AddAdapter(this);
    }
    
    // Reset the visitor, clearing the StringBuilder and setting indentation to initial level.
    public void Reset()
    {
        m_Builder.Clear();
        m_IndentLevel = k_InitialIndent;
    }

    // Get the string representation of the dumped object.
    public string GetDump()
    {
        return m_Builder.ToString();
    }

    // Helper method to get the property name, handling collections and other property types.
    private static string GetPropertyName(IProperty property)
    {
        return property switch
        {
            // If it's a collection element property, display it with brackets
            ICollectionElementProperty =&gt; $&quot;[{property.Name}]&quot;,
            // For other property types, display the name as it is
            _ =&gt; property.Name
        };
    }

    // This method is called when visiting each property of an object.
    // It determines the type of the value and formats it accordingly for display.
    protected override void VisitProperty&lt;TContainer, TValue&gt;(Property&lt;TContainer, TValue&gt; property, ref TContainer container, ref TValue value)
    {
        var propertyName = GetPropertyName(property);

        // Get the type of the value or property.
        var type = value?.GetType() ?? property.DeclaredValueType();
        var typeName = TypeUtility.GetTypeDisplayName(type);
        
        // Only display the values for primitives, enums, and strings, and treat other types as containers.
        if (TypeTraits.IsContainer(type))
            m_Builder.AppendLine($&quot;{Indent}- {propertyName} {{{typeName}}}&quot;);
        else
            m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{typeName}}} {value}&quot;);
        
        // Increase indentation level before visiting child properties (if any).
        ++m_IndentLevel;
        if (null != value)
            PropertyContainer.Accept(this, ref value);
        // Decrease indentation level after visiting child properties.
        --m_IndentLevel;
    }

    // This method is a specialized override for Vector2 properties.
    // It displays the property name and its value as a Vector2.
    void IVisitPropertyAdapter&lt;Vector2&gt;.Visit&lt;TContainer&gt;(in VisitContext&lt;TContainer, Vector2&gt; context, ref TContainer container, ref Vector2 value)
    {
        var propertyName = GetPropertyName(context.Property);
        m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{nameof(Vector2)}}} {value}&quot;);
    }

    // This method is a specialized override for Color properties.
    // It displays the property name and its value as a Color.
    void IVisitPropertyAdapter&lt;Color&gt;.Visit&lt;TContainer&gt;(in VisitContext&lt;TContainer, Color&gt; context, ref TContainer container, ref Color value)
    {
        var propertyName = GetPropertyName(context.Property);
        m_Builder.AppendLine($&quot;{Indent}- {propertyName} = {{{nameof(Color)}}} {value}&quot;);
    }
}
</code></pre>

<h2>Print the current state of a sub-properties</h2>

<p>When you run a visitor on data, by default, it starts the visitation on the given object directly. For any property visitor, to start the visitation on sub-properties of an object, pass a <a href="../ScriptReference/Unity.Properties.PropertyPath.html"><code>PropertyPath</code></a> to the <a href="../ScriptReference/Unity.Properties.PropertyContainer.Accept.html"><code>PropertyContainer.Accept</code></a> method. </p>

<ol>
<li>
<p>Update the <code>DebugUtilities</code> method to take an optional <code>PropertyPath</code>:</p>

<pre><code class="lang-csharp">public static class DebugUtilities
{
    private static readonly DumpObjectVisitor s_Visitor = new();

    public static void PrintObjectDump&lt;T&gt;(T value, PropertyPath path = default)
    {
        s_Visitor.Reset();
        if (path.IsEmpty)
            PropertyContainer.Accept(s_Visitor, ref value);
        else
            PropertyContainer.Accept(s_Visitor, ref value, path);
        Debug.Log(s_Visitor.GetDump());
    }
}
</code></pre>
</li>
<li><p>Call the <code>PrintObjectDump</code> method with the <code>Data</code> object. This gets the <a href="#desired-output">desired output</a>.</p></li>
</ol>

<h2>Additional resources</h2>

<ul>
<li><a href="property-visitors.html">Property visitors</a></li>
<li><a href="property-bags.html">Property bags</a></li>
<li><a href="property-paths.html">Property paths</a></li>
<li><a href="property-visitors-low-level-api.html">Use low-level APIs to create a property visitor</a></li>
</ul>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="property-paths.html"></a></span><div class="tip">Property paths</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="property-visitors-low-level-api.html"></a></span><div class="tip">Use low-level APIs to create a property visitor</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2024 Unity Technologies. Publication Date: 2024-10-03.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a><a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a><a href="https://unity.com/legal">Legal</a><a href="https://unity.com/legal/privacy-policy">Privacy Policy</a><a href="https://unity.com/legal/cookie-policy">Cookies</a><a href="https://unity.com/legal/do-not-sell-my-personal-information">Do Not Sell or Share My Personal Information</a><div id="ot-sdk-btn-container"><a id="ot-sdk-btn" class="ot-sdk-show-settings" href="javascript:void(0);">Your Privacy Choices (Cookie Settings)</a></div>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
