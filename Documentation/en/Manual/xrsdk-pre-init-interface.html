<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836" data-dLayer-ignore="true" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() {}</script><script>window.dataLayer = window.dataLayer || []; dataLayer.push({ event: 'dataLayer-initialized', user: { user_unity_id: undefined, user_logged_in: 'no' }, environment: { environment_locale: 'en-us', environment_currency: undefined }});</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: XR SDK PreInit interface</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=20241003"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=20241003"></script><script type="text/javascript" src="docdata/toc.js?ts=20241003"></script><script type="text/javascript" src="docdata/global_toc.js?ts=20241003"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=20241003">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2022.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/xrsdk-pre-init-interface.html">English</a></li>
<li><a href="/cn/current/Manual/xrsdk-pre-init-interface.html">中文</a></li>
<li><a href="/ja/current/Manual/xrsdk-pre-init-interface.html">日本語</a></li>
<li><a href="/kr/current/Manual/xrsdk-pre-init-interface.html">한국어</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2022.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/xrsdk-pre-init-interface.html">English</a></li>
<li><a href="/cn/current/Manual/xrsdk-pre-init-interface.html">中文</a></li>
<li><a href="/ja/current/Manual/xrsdk-pre-init-interface.html">日本語</a></li>
<li><a href="/kr/current/Manual/xrsdk-pre-init-interface.html">한국어</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="PlatformSpecific.html">Platform development  </a></li>
<li><a href="XR.html">XR</a></li>
<li><a href="xr-sdk.html">Unity XR SDK</a></li>
<li>Interfaces</li>
<li>XR SDK PreInit interface</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="xrsdk-meshing.html"></a></span><div class="tip">XR SDK Meshing subsystem</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="xrsdk-stats.html"></a></span><div class="tip">XR SDK Stats interface</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>XR SDK PreInit interface</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>This interface allows you to configure the graphics device before it’s created. Common use cases include choosing a specific GPU in multi-GPU scenarios, enabling graphics extensions, and modifying buffer creation.</p>

<h2>Overview</h2>

<p>Your provider can export the native symbol <code>XRSDKPreInit</code>, which is called early in runtime initialization, before graphics device creation. It should fill out a <code>UnityXRPreInitProvider</code> structure with the relevant entry points for providing the engine with information it might need during early initialization. Some providers need this because the graphics device is created before providers are able to initialize.</p>

<h2>Discovery</h2>

<p>The Unity project build process requires the name of your provider library before it can call <code>XRSDKPreInit()</code> at engine startup. To do this, implement the <code>IXRLoaderPreInit.GetPreInitLibraryName</code> interface on your <code>XRLoader</code>:</p>

<pre><code class="csharp">public string GetPreInitLibraryName(BuildTarget buildTarget, BuildTargetGroup buildTargetGroup)
{
    return &quot;XRSDKMyProviderLibraryName&quot;;
}
</code></pre>

<p>When Unity starts up, it runs the code above to load the library. Then, Unity opens that library, looks for the <code>XRSDKPreInit</code> export, and calls it. At that point, <code>XRSDKPreInit</code> should register a <code>UnityXRPreInitProvider</code>.</p>

<h2>Registration in XRSDKPreInit</h2>

<p>Here’s a simple example that registers all of the callbacks that you can use for early engine initialization:</p>

<pre><code class="cpp">XRSDKPreInit(IUnityInterfaces * interfaces)
{
    IUnityXRPreInit* preInit = (IUnityXRPreInit*)interfaces-&gt;GetInterface(GetUnityInterfaceGUID&lt;IUnityXRPreInit&gt;());

    UnityXRPreInitProvider provider = { 0 };

    provider.userData = nullptr;
    provider.GetPreInitFlags = GetPreInitFlags;
    provider.GetGraphicsAdapterId = GetGraphicsAdapterId;
    provider.GetVulkanInstanceExtensions = GetVulkanInstanceExtensions;
    provider.GetVulkanDeviceExtensions = GetVulkanDeviceExtensions;

    preInit-&gt;RegisterPreInitProvider(&amp;provider);
}
</code></pre>

<p>Set any callbacks that you don’t need to <code>nullptr</code>.</p>

<hr>

<h2>Callbacks</h2>

<h3>GetPreInitFlags</h3>

<p>
<code>GetPreInitFlags</code> returns a 64-bit bitfield of flags. The following flags are currently exposed:</p>

<ul>
<li>
<code>kUnityXRPreInitFlagsEGLUsePBuffer</code> - On EGL platforms (Android, standalone Meta/Oculus devices, etc.), EGL should be initialized using PBuffers.</li>
<li>
<code>kUnityXRPreInitFlagsEGLUseNoErrorContext</code> - On EGL platforms, EGL should be initialized with a NO_ERROR context.</li>
</ul>

<p>Providers shouldn’t set any undefined bits, as they might be used for future expansion.</p>

<h3>GetGraphicsAdapterId</h3>

<p>
<code>GetGraphicsAdapterId</code> sets the graphics adapter that the Unity runtime graphics device uses for graphics API initialization. For example, if a user plugs a headset into a different GPU than the user’s primary display device, Unity might need to initialize the graphics API that explicitly targets the secondary GPU.</p>

<h3>GetVulkanDeviceExtensions and GetVulkanInstanceExtensions</h3>

<p>
<code>GetVulkanDeviceExtensions</code> and <code>GetVulkanInstanceExtensions</code> are used if the provider needs Unity to initialize Vulkan with specific extensions for the device and instance. This is often used for compositor surface sharing. Both of these return a space-separated string of extensions.</p>

<hr>

<h2>Known issues</h2>

<ul>
<li>Currently, <code>GetPreInitLibraryName</code> is only called on the first XRLoader in the XRManager <span class="tooltip"><strong>prefab</strong><span class="tooltiptext">An asset type that allows you to store a GameObject complete with components and properties. The prefab acts as a template from which you can create new object instances in the scene. <a class="tooltipMoreInfoLink" href="Prefabs.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Prefab">Glossary</a></span></span></span>, so only the first Provider in the list can provide PreInit entry points at runtime.</li>
<li>PreInit requires a native library to expose the entry point during early engine initialization.</li>
<li>PreInit doesn’t apply to the Editor at this time.</li>
</ul>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="xrsdk-meshing.html"></a></span><div class="tip">XR SDK Meshing subsystem</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="xrsdk-stats.html"></a></span><div class="tip">XR SDK Stats interface</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2024 Unity Technologies. Publication Date: 2024-10-03.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a><a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a><a href="https://unity.com/legal">Legal</a><a href="https://unity.com/legal/privacy-policy">Privacy Policy</a><a href="https://unity.com/legal/cookie-policy">Cookies</a><a href="https://unity.com/legal/do-not-sell-my-personal-information">Do Not Sell or Share My Personal Information</a><div id="ot-sdk-btn-container"><a id="ot-sdk-btn" class="ot-sdk-show-settings" href="javascript:void(0);">Your Privacy Choices (Cookie Settings)</a></div>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
