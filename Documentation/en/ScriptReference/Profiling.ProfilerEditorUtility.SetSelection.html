<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836" data-dLayer-ignore="true" data-document-language="true">
    </script>
    <script type="text/javascript">function OptanonWrapper() {}</script>
    <script>window.dataLayer = window.dataLayer || []; dataLayer.push({ event: 'dataLayer-initialized', user: { user_unity_id: undefined, user_logged_in: 'no' }, environment: { environment_locale: 'en-us', environment_currency: undefined }});</script>
    <script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script>
    <link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Unity - Scripting API: Profiling.ProfilerEditorUtility.SetSelection</title>
    <meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg" />
    <meta name="author" content="Unity Technologies" />
    <link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico" />
    <link rel="icon" type="image/png" href="../../../StaticFiles/images/favicons/favicon.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png" />
    <meta name="msapplication-TileColor" content="#222c37" />
    <meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png" />
    <script type="text/javascript" src="/StaticFilesConfig/UnityVersionsInfo.js">
    </script>
    <script type="text/javascript" src="../StaticFiles/js/jquery.js">
    </script>
    <script type="text/javascript" src="docdata/toc.js">//toc</script>
    <!--local TOC-->
    <script type="text/javascript" src="docdata/global_toc.js">//toc</script>
    <!--global TOC, including other platforms-->
    <script type="text/javascript" src="../StaticFiles/js/core.js">
    </script>
    <link rel="stylesheet" href="../StaticFiles/css/prism.css" />
    <script type="text/javascript" src="../StaticFiles/js/prism.js">
    </script>
    <link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css" />
    <script src="/StaticFilesConfig/feedback/feedback.js">
    </script>
    <script src="../StaticFiles/js/jquery.sidebar.min.js">
    </script>
    <script type="text/javascript" src="../StaticFiles/js/mobileoptimisation.js">
    </script>
    <link rel="stylesheet" href="../StaticFiles/css/mobileoptimisation.css" />
  </head>
  <body>
    <div id="DocsAnalyticsData" data-area="none" data-pagetype="scriptref">
    </div>
    <div class="header-wrapper">
      <div id="header" class="header">
        <div class="content">
          <div class="spacer">
            <div class="menu">
              <div id="nav-open" for="nav-input">
                <span>
                </span>
              </div>
              <div class="logo">
                <a href="">
                </a>
              </div>
              <div class="search-form">
                <form action="30_search.html" method="get" class="apisearch">
                  <input type="text" name="q" placeholder="Search scripting..." autosave="Unity Reference" results="5" class="sbox field" id="q">
                  </input>
                  <input type="submit" class="submit">
                  </input>
                </form>
              </div>
              <ul>
                <li>
                  <a href="../Manual/index.html">Manual</a>
                </li>
                <li>
                  <a href="../ScriptReference/index.html" class="selected">Scripting API</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="more">
            <div class="filler">
            </div>
            <ul>
              <li>
                <a href="https://unity.com/">unity.com</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="toolbar">
        <div class="content clear">
          <div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2022.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;"><ul id="OtherVersionsContentUl"></ul><div id="otherVersionsLegend"><ul><li><div id="supportedColour" class="legendBox"></div>Supported</li><li><div id="notFoundColour" class="legendBox"></div>Legacy</li></ul></div></div><div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div></div>
          <div class="lang-switcher hide">
            <div class="current toggle" data-target=".lang-list">
              <div class="lbl">Language<span class="b">English</span></div>
              <div class="arrow">
              </div>
            </div>
            <div class="lang-list" style="display:none;">
              <ul>
                <li>
                  <a href="">English</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="script-lang">
            <ul>
              <li class="selected" data-lang="CS">C#</li>
            </ul>
          </div>
          <div class="mobileLogo">
            <a href="https://docs.unity3d.com">
            </a>
          </div>
        </div>
      </div>
    </div>
    <div id="master-wrapper" class="master-wrapper clear">
      <div id="sidebar" class="sidebar">
        <div class="sidebar-wrap">
          <div class="content">
            <div class="sidebar-menu">
              <div class="toc" id="customScrollbar">
                <h2>Scripting API</h2>
                <div class="search-form sidebar-search-form">
                  <form action="30_search.html" method="get" class="apisearch">
                    <input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q">
                    </input>
                    <input type="submit" id="mobileSearchBtn" class="submit" value="Search">
                    </input>
                  </form>
                </div>
                <div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent">
                  <form id="otherVersionsContentMobileForm">
                    <div class="ui-field-contain">
                      <label for="select-native-4">Version: 2022.3</label>
                      <select name="select-native-4" id="versionsSelectMobile">
                        <option>Select a different version</option>
                        <optgroup id="versionsWithThisPageMobile" label="Versions with this page">
                        </optgroup>
                        <optgroup id="versionsWithoutThisPageMobile" label="Versions without this page">
                        </optgroup>
                      </select>
                    </div>
                  </form>
                </div>
                <div class="lang-switcher hide">
                  <div class="toggle" data-target=".lang-list">
                    <div class="lbl">Language<span class="b">English</span></div>
                    <div class="arrow">
                    </div>
                  </div>
                  <div class="lang-list" style="display:none;">
                    <ul>
                      <li>
                        <a href="">English</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="content-wrap" class="content-wrap">
        <div class="content-block">
          <div class="content">
            <div class="section">
              <div class="mb20 clear" id="">
                <h1 class="heading inherit">
                  <a href="Profiling.ProfilerEditorUtility.html">ProfilerEditorUtility</a>.SetSelection</h1>
                <div class="clear">
                </div>
                <div class="scrollToFeedback">
                  <a id="scrollToFeedback">Leave feedback</a>
                </div>
                <div class="clear">
                </div>
                <div class="suggest">
                  <a class="blue-btn sbtn">Suggest a change</a>
                  <div class="suggest-wrap rel hide">
                    <div class="loading hide">
                      <div>
                      </div>
                      <div>
                      </div>
                      <div>
                      </div>
                    </div>
                    <div class="suggest-success hide">
                      <h2>Success!</h2>
                      <p>Thank you for helping us improve the quality of Unity Documentation. Although we cannot accept all submissions, we do read each suggested change from our users and will make updates where applicable.</p>
                      <a class="gray-btn sbtn close">Close</a>
                    </div>
                    <div class="suggest-failed hide">
                      <h2>Submission failed</h2>
                      <p>For some reason your suggested change could not be submitted. Please &lt;a&gt;try again&lt;/a&gt; in a few minutes. And thank you for taking the time to help us improve the quality of Unity Documentation.</p>
                      <a class="gray-btn sbtn close">Close</a>
                    </div>
                    <div class="suggest-form clear">
                      <label for="suggest_name">Your name</label>
                      <input id="suggest_name" type="text">
                      </input>
                      <label for="suggest_email">Your email</label>
                      <input id="suggest_email" type="email">
                      </input>
                      <label for="suggest_body" class="clear">Suggestion<span class="r">*</span></label>
                      <textarea id="suggest_body" class="req">
                      </textarea>
                      <button id="suggest_submit" class="blue-btn mr10">Submit suggestion</button>
                      <p class="mb0">
                        <a class="cancel left lh42 cn">Cancel</a>
                      </p>
                    </div>
                  </div>
                </div>
                <a href="" class="switch-link gray-btn sbtn left hide">
                </a>
                <div class="clear">
                </div>
              </div>
              <div class="subsection">
                <div class="signature">
                  <div class="signature-CS sig-block">
                    <span style="color:red;">
                    </span>
                    <h2>Declaration</h2>public static bool <span class="sig-kw">SetSelection</span>(<a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.html">Profiling.IProfilerFrameTimeViewSampleSelectionController</a> <span class="sig-kw">controller</span>,
string <span class="sig-kw">markerNameOrMarkerNamePath</span>,
long <span class="sig-kw">frameIndex</span>,
string <span class="sig-kw">threadGroupName</span>,
string <span class="sig-kw">threadName</span>,
ulong <span class="sig-kw">threadId</span>);
    </div>
                </div>
              </div>
              <div class="subsection">
                <h3>Parameters</h3>
                <table class="list">
                  <tr>
                    <td class="name lbl">controller</td>
                    <td class="desc">The controller object of the Profiler module whose selection you want to set. When the value is null, Unity throws a NullArgumentException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">markerNameOrMarkerNamePath</td>
                    <td class="desc">The name of the sample to be selected, or the names of all samples in the sample stack. Separate each name with a <code class="mono">/</code>, ending on the sample that should be selected. Do not add a trailing <code class="mono">/</code>. If Unity cannot find a sample that matches this name or sample stack, it does not set a selection and this method returns false. When this value is null or an empty string, Unity throws an ArgumentException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">frameIndex</td>
                    <td class="desc">The 0 based frame index. This value defaults to -1 which means the selection is set on the currently shown frame. Note that the Profiler Window UI shows the frame index as n+1. When this value is outside of the range described by <a href="ProfilerWindow-firstAvailableFrameIndex.html">ProfilerWindow.firstAvailableFrameIndex</a> and <a href="ProfilerWindow-lastAvailableFrameIndex.html">ProfilerWindow.lastAvailableFrameIndex</a>, or not -1, Unity throws an ArgumentOutOfRangeException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">threadGroupName</td>
                    <td class="desc">The name of the thread group. The parameter defaults to an empty string. Null or an empty string signify that the thread isn't part of a thread group. "Job", "Loading" and "Scripting Threads" are examples of such thread group names.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">threadName</td>
                    <td class="desc">The Name of the thread, e.g. "Main Thread", "Render Thread" or "Worker 0". This parameter defaults to "Main Thread". When this value is null or an empty string, Unity throws an ArgumentException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">threadId</td>
                    <td class="desc">The ID of the thread. When the default value of <a href="Profiling.FrameDataView-invalidThreadId.html">FrameDataView.invalidThreadId</a> is passed, Unity searches for the sample in the first thread matching the provided threadGroupName and threadName. Specify this threadId if there are multiple threads with the same name. Use a RawFrameDataView.threadId or HierarchyFrameDataView.threadId to retrieve the ID to a specific thread, if you need it to be specific.</td>
                  </tr>
                </table>
              </div>
              <div class="subsection">
                <h3>Returns</h3>
                <p>
                  <strong>bool</strong>
        Returns true if the selection was successfully set, false if it was rejected because no fitting sample could be found.
      </p>
              </div>
              <div class="subsection">
                <h3>Description</h3>
                <p>Set the current selection in a frame time sample based Profiler Module, such as the <a href="../Manual/ProfilerCPU.html">CPU Usage module</a> and the <a href="../Manual/ProfilerGPU.html">GPU Usage Profiler module</a>.</p>
              </div>
              <div class="subsection">
        <p>Use these extension methods to <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.html">IProfilerFrameTimeViewSampleSelectionController</a> to search for a sample according to its name or Profiler Marker Id, the frame and the thread it occurred in and optionally a sample stack within which it should be found. If a sample matching these criteria is found, this method will return true and you can get the details on the found and set selection via <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController-selection.html">IProfilerFrameTimeViewSampleSelectionController.selection</a>.<br /><br />When no frame data is available in the Profiler Window, Unity throws an Exception. You can check that <a href="ProfilerWindow-firstAvailableFrameIndex.html">ProfilerWindow.firstAvailableFrameIndex</a> is greater or equal to 0 to validate that frame data is available.<br /><br />When the specified thread can not be found, Unity throws an ArgumentException.<br /><br />If you know the rawSampleIndex to the sample you want to select, you can use <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.SetSelection.html">IProfilerFrameTimeViewSampleSelectionController.SetSelection</a> directly to set the selection.
Additional resources: <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.SetSelection.html">IProfilerFrameTimeViewSampleSelectionController.SetSelection</a> and <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.ClearSelection.html">IProfilerFrameTimeViewSampleSelectionController.ClearSelection</a>.</p>
      </div>
              <hr class="section" />
              <div class="subsection">
                <div class="signature">
                  <div class="signature-CS sig-block">
                    <span style="color:red;">
                    </span>
                    <h2>Declaration</h2>public static bool <span class="sig-kw">SetSelection</span>(<a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.html">Profiling.IProfilerFrameTimeViewSampleSelectionController</a> <span class="sig-kw">controller</span>,
long <span class="sig-kw">frameIndex</span>,
string <span class="sig-kw">threadGroupName</span>,
string <span class="sig-kw">threadName</span>,
string <span class="sig-kw">sampleName</span>,
string <span class="sig-kw">markerNamePath</span>,
ulong <span class="sig-kw">threadId</span>);
    </div>
                  <div class="signature-CS sig-block">
                    <span style="color:red;">
                    </span>
                    <h2>Declaration</h2>public static bool <span class="sig-kw">SetSelection</span>(<a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.html">Profiling.IProfilerFrameTimeViewSampleSelectionController</a> <span class="sig-kw">controller</span>,
long <span class="sig-kw">frameIndex</span>,
string <span class="sig-kw">threadGroupName</span>,
string <span class="sig-kw">threadName</span>,
int <span class="sig-kw">sampleMarkerId</span>,
List&lt;int&gt; <span class="sig-kw">markerIdPath</span>,
ulong <span class="sig-kw">threadId</span>);
    </div>
                </div>
              </div>
              <div class="subsection">
                <h3>Parameters</h3>
                <table class="list">
                  <tr>
                    <td class="name lbl">controller</td>
                    <td class="desc">The controller object of the Profiler module whose selection you want to set. When the value is null, Unity throws a NullArgumentException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">frameIndex</td>
                    <td class="desc">The 0 based frame index. Note that the Profiler Window UI shows the frame index as n+1. When this value is outside of the range described by <a href="ProfilerWindow-firstAvailableFrameIndex.html">ProfilerWindow.firstAvailableFrameIndex</a> and <a href="ProfilerWindow-lastAvailableFrameIndex.html">ProfilerWindow.lastAvailableFrameIndex</a>, or smaller than 0, Unity throws an ArgumentOutOfRangeException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">threadGroupName</td>
                    <td class="desc">The name of the thread group. Null or an empty string signify that the thread isn't part of a thread group. "Job", "Loading" and "Scripting Threads" are examples of such thread group names.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">threadName</td>
                    <td class="desc">The Name of the thread, e.g. "Main Thread", "Render Thread" or "Worker 0". When this value is null or an empty string, Unity throws an ArgumentException.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">sampleName</td>
                    <td class="desc">The name of the sample to select. If Unity cannot find a sample that matches this name, it does not set a selection and this method returns false. When this value is null or an empty string, Unity throws an ArgumentNullException or ArgumentException respectively.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">markerNamePath</td>
                    <td class="desc">The names of all samples in the sample stack, each separated by a <code class="mono">/</code>, that define the base path for the search. Similar to a file folder structure, this base path defines where Unity looks for a sample which matches the sampleName. The searched sampleName can be the last item in that marker path or any child sample of it. Do not add a trailing <code class="mono">/</code>. If no sample can be found matching this sample stack path and the sampleName, no selection is set and this method returns false. This defaults to null which means no requirement is set on the sample's sample stack and the first sample fitting the sampleName is selected.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">threadId</td>
                    <td class="desc">The ID of the thread. When the default value of <a href="Profiling.FrameDataView-invalidThreadId.html">FrameDataView.invalidThreadId</a> is passed, Unity searches for the sample in the first thread matching the provided threadGroupName and threadName. Specify this threadId if there are multiple threads with the same name. Use a RawFrameDataView.threadId or HierarchyFrameDataView.threadId to retrieve the ID to a specific thread, if you need it to be specific.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">sampleMarkerId</td>
                    <td class="desc">Use <a href="Profiling.HierarchyFrameDataView.html">HierarchyFrameDataView</a> or <a href="Profiling.RawFrameDataView.html">RawFrameDataView</a> to get the Marker Ids. When no sample can be found matching this sample stack path and the sampleMarkerId, no selection is set and this method returns false.</td>
                  </tr>
                  <tr>
                    <td class="name lbl">markerIdPath</td>
                    <td class="desc">A list of Profiler marker IDs for all samples in the sample stack, that define the base path for the search. Similar to a file folder structure, this base path defines where Unity looks for a sample which matches the sampleMarkerId. The searched sampleMarkerId can be the last item in that marker path or any child sample of it. If no sample can be found matching this sample stack path and the sampleMarkerId, no selection is set and this method returns false. This defaults to null which means no requirement is set on the sample's sample stack and the first sample fitting the sampleMarkerId is selected.</td>
                  </tr>
                </table>
              </div>
              <div class="subsection">
                <h3>Returns</h3>
                <p>
                  <strong>bool</strong>
        Returns true if the selection was successfully set, false if it was rejected because no fitting sample could be found.
      </p>
              </div>
              <div class="subsection">
                <h3>Description</h3>
                <p>Set the current selection in a frame time sample based Profiler Module, such as the <a href="../Manual/ProfilerCPU.html">CPU Usage module</a> and the <a href="../Manual/ProfilerGPU.html">GPU Usage Profiler module</a>.</p>
              </div>
              <div class="subsection">
        <p>Use these extension methods to <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.html">IProfilerFrameTimeViewSampleSelectionController</a> to search for a sample according to its name or Profiler Marker Id, the frame and the thread it occurred in and optionally a sample stack within which it should be found. If a sample matching these criteria is found, this method will return true and you can get the details on the found and set selection via <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController-selection.html">IProfilerFrameTimeViewSampleSelectionController.selection</a>.<br /><br />When no frame data is available in the Profiler Window, Unity throws an Exception. You can check that <a href="ProfilerWindow-firstAvailableFrameIndex.html">ProfilerWindow.firstAvailableFrameIndex</a> is greater or equal to 0 to validate that frame data is available.<br /><br />When no frame data is available in the Profiler Window, Unity throws an Exception. You can check that <a href="ProfilerWindow-firstAvailableFrameIndex.html">ProfilerWindow.firstAvailableFrameIndex</a> is greater or equal to 0 to validate that frame data is available.<br /><br />When the specified thread can not be found, Unity throws an ArgumentException.<br /><br />If you know the rawSampleIndex to the sample you want to select, you can use <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.SetSelection.html">IProfilerFrameTimeViewSampleSelectionController.SetSelection</a> directly to set the selection.
Additional resources: <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.SetSelection.html">IProfilerFrameTimeViewSampleSelectionController.SetSelection</a> and <a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.ClearSelection.html">IProfilerFrameTimeViewSampleSelectionController.ClearSelection</a>.</p>
      </div>
              <div class="subsection">
        <pre class="codeExampleCS">
using <a href="Rendering.VirtualTexturing.System.html">System</a>;
using System.Collections.Generic;
using <a href="UnityEditor.html">UnityEditor</a>;
using UnityEditor.Profiling;
using UnityEditorInternal;
using UnityEngine;<br /><br />// This example assumes the profiled scene contained a component of MyScript.cs:
/* using UnityEngine;<br /><br />public class MyScript : <a href="MonoBehaviour.html">MonoBehaviour</a>
{
    void <a href="PlayerLoop.Update.html">Update</a>()
    {
        MethodWithABoxingAllocation();
    }<br /><br />    object MethodWithABoxingAllocation()
    {
        return 1;
    }
}*/<br /><br />public class Example : <a href="EditorWindow.html">EditorWindow</a>
{
    const string k_MainThreadGroupName = "";
    const string k_MainThreadName = "Main Thread";
    const string k_GCAllocSampleName = "GC.Alloc";
    // <a href="Profiling.Profiler.html">Profiler</a> samples that were instrumented by Unity's <a href="VersionControl.Message.html">Message</a> Invoking mechanism,
    // e.g. <a href="PlayerLoop.Update.html">Update</a>(), Start(), <a href="PlayerLoop.FixedUpdate.html">FixedUpdate</a>() ... get an " [Invoke]" postfix
    const string k_InvokePostFix = " [Invoke]";
    public enum UpdateNameMatchType
    {
        Short,
        Full,
    }<br /><br />    <a href="ProfilerWindow.html">ProfilerWindow</a> m_Profiler = null;
    UpdateNameMatchType m_UpdateNameMatchType = UpdateNameMatchType.Short;
    bool m_UseMarkerNames = true;<br /><br />    string GetUpdateSampleName(UpdateNameMatchType updateNameMatchType, bool deepProfiling)
    {
        switch (updateNameMatchType)
        {
            case UpdateNameMatchType.Short:
                if (deepProfiling)
                    return k_UpdateSampleNameShort;
                return k_UpdateSampleNameShort + k_InvokePostFix;
            case UpdateNameMatchType.Full:
                if (deepProfiling)
                    return k_UpdateSampleNameFull;<br /><br />                return k_UpdateSampleNameFull + k_InvokePostFix;
            default:
                throw new NotImplementedException();
        }
    }<br /><br />    const string k_UpdateSampleNameFull = "<a href="Compilation.Assembly.html">Assembly</a>-CSharp.dll!::MyScript.Update()";
    // Invoked method samples or samples instrumented via Deep Profiling will by default be shown
    // without their fully qualifying type name as above
    // Instead the <a href="Profiling.Profiler.html">Profiler</a> UI will strip out everything before the '!::' part of their name.
    // SetSelection will still find these samples, if the UI is set to not Show Full Scripting Method Names
    // Note that <a href="Profiling.RawFrameDataView.html">RawFrameDataView</a> and <a href="Profiling.HierarchyFrameDataView.html">HierarchyFrameDataView</a> will not be able to identify the Marker IDs
    // for such samples from this shorter name.
    const string k_UpdateSampleNameShort = "MyScript.Update()";<br /><br />    static readonly List&lt;string&gt; k_SampleNames = new List&lt;string&gt;
    {
        "<a href="LowLevel.PlayerLoop.html">PlayerLoop</a>",
        "Update.ScriptRunBehaviourUpdate",
        "BehaviourUpdate",
    };<br /><br />    [<a href="MenuItem.html">MenuItem</a>("Window/Analysis/<a href="Profiling.Profiler.html">Profiler</a> Extension")]
    public static void ShowExampleWindow()
    {
        var window = GetWindow&lt;Example&gt;();
        window.m_Profiler = <a href="EditorWindow.GetWindow.html">EditorWindow.GetWindow</a>&lt;<a href="ProfilerWindow.html">ProfilerWindow</a>&gt;();
    }<br /><br />    void OnGUI()
    {
        // First make sure there is an open <a href="Profiling.Profiler.html">Profiler</a> Window
        if (m_Profiler == null)
            m_Profiler = <a href="EditorWindow.GetWindow.html">EditorWindow.GetWindow</a>&lt;<a href="ProfilerWindow.html">ProfilerWindow</a>&gt;();<br /><br />        // For demonstration purposes, let the user choose if the names or if Marker IDs should be used.
        m_UseMarkerNames = <a href="GUILayout.Toggle.html">GUILayout.Toggle</a>(m_UseMarkerNames, "Use Marker names instead of IDs");
        if (!m_UseMarkerNames)
            m_UpdateNameMatchType = UpdateNameMatchType.Full;<br /><br />        // Marker IDs need to be gotten from the fully qualified type name, so the shorter name is not an option when using IDs
        using (new <a href="EditorGUI.DisabledScope.html">EditorGUI.DisabledScope</a>(!m_UseMarkerNames))
        {
            // For demonstration purposes, let the user choose if the short or the long name should be used.
            m_UpdateNameMatchType = (UpdateNameMatchType)<a href="EditorGUILayout.EnumPopup.html">EditorGUILayout.EnumPopup</a>(m_UpdateNameMatchType);
        }<br /><br />        // If the currently selected Module is not the CPU Usage module, setting the selection will not be visible to the user immediately
        if (m_Profiler.selectedModuleIdentifier == <a href="ProfilerWindow-cpuModuleIdentifier.html">ProfilerWindow.cpuModuleIdentifier</a>)
        {
            // Get the CPU Usage <a href="Profiling.Profiler.html">Profiler</a> module's selection controller interface to interact with the selection
            var cpuSampleSelectionController = m_Profiler.GetFrameTimeViewSampleSelectionController(<a href="ProfilerWindow-cpuModuleIdentifier.html">ProfilerWindow.cpuModuleIdentifier</a>);
            // If the current selection object is null, there is no selection to print out.
            using (new <a href="EditorGUI.DisabledScope.html">EditorGUI.DisabledScope</a>(m_Profiler.lastAvailableFrameIndex &lt; 0))
            {
                if (<a href="GUILayout.Button.html">GUILayout.Button</a>("Check my Script for GC.Alloc"))
                {
                    string samplePath = "";
                    for (int i = 0; i &lt; k_SampleNames.Count; i++)
                    {
                        samplePath += $"{k_SampleNames[i]}/";
                    }<br /><br />                    var samplePathDeepProfiling = samplePath + $"{GetUpdateSampleName(m_UpdateNameMatchType, true)}/";
                    samplePath = samplePath + $"{GetUpdateSampleName(m_UpdateNameMatchType, false)}/";
                    // the sample we are looking for, without a trailing '/'
                    samplePath += k_GCAllocSampleName;
                    samplePathDeepProfiling += k_GCAllocSampleName;<br /><br />                    // This check will fail in Deep Profiling because "MethodWithABoxingAllocation()" will be instrumented
                    // and sitting in the sample stack between "<a href="PlayerLoop.Update.html">Update</a>()" and the "GC.Alloc".
                    if (cpuSampleSelectionController.SetSelection(samplePath) || cpuSampleSelectionController.SetSelection(samplePathDeepProfiling))
                    {
                        <a href="Debug.LogWarning.html">Debug.LogWarning</a>("MyScript allocates in its <a href="PlayerLoop.Update.html">Update</a> loop");
                    }
                    else
                    {
                        if (m_UseMarkerNames)
                        {
                            samplePath = "";
                            for (int i = 0; i &lt; k_SampleNames.Count; i++)
                            {
                                samplePath += $"{k_SampleNames[i]}{ (i &lt; k_SampleNames.Count - 1 ?"/": "")}";
                            }
                            // SetSelection calls that take sample names as strings will find shortened scripting sample names
                            var mySctiprSamplePathDeepProfiling = $"{samplePath}/{GetUpdateSampleName(m_UpdateNameMatchType, true)}";
                            var myScriptSamplePath = $"{samplePath}/{GetUpdateSampleName(m_UpdateNameMatchType, false)}";<br /><br />                            if (cpuSampleSelectionController.SetSelection(m_Profiler.selectedFrameIndex,
                                k_MainThreadGroupName, k_MainThreadName, k_GCAllocSampleName, myScriptSamplePath) ||
                                cpuSampleSelectionController.SetSelection(m_Profiler.selectedFrameIndex,
                                    k_MainThreadGroupName, k_MainThreadName, k_GCAllocSampleName, mySctiprSamplePathDeepProfiling))
                            {
                                <a href="Debug.LogWarning.html">Debug.LogWarning</a>("MyScript allocates in its <a href="PlayerLoop.Update.html">Update</a> loop");
                            }
                            // MyScript did not have a GC.Alloc sample underneath it, but maybe a different <a href="PlayerLoop.Update.html">Update</a> sample allocated
                            // Search through all <a href="PlayerLoop.Update.html">Update</a>() samples
                            else if (cpuSampleSelectionController.SetSelection(m_Profiler.selectedFrameIndex,
                                k_MainThreadGroupName, k_MainThreadName, k_GCAllocSampleName, samplePath))
                            {
                                <a href="Debug.LogWarning.html">Debug.LogWarning</a>($"MyScript does not allocate but {cpuSampleSelectionController.selection.markerNamePath[k_SampleNames.Count]} allocates in its <a href="PlayerLoop.Update.html">Update</a> loop");
                            }
                            else
                            {
                                <a href="Debug.Log.html">Debug.Log</a>("No Script is allocating in its <a href="PlayerLoop.Update.html">Update</a> Loop");
                                FindAnyGCAllocSample(cpuSampleSelectionController);
                            }
                        }
                        else
                        {
                            List&lt;int&gt; markerIdPath = new List&lt;int&gt;(k_SampleNames.Count + 1);
                            List&lt;int&gt; deepProfilingmarkerIdPath = new List&lt;int&gt;(k_SampleNames.Count + 1);
                            int gcAllocMarkerId = <a href="Profiling.FrameDataView-invalidMarkerId.html">FrameDataView.invalidMarkerId</a>;
                            using (var frameData = ProfilerDriver.GetRawFrameDataView((int)m_Profiler.selectedFrameIndex, 0))
                            {
                                for (int i = 0; i &lt; k_SampleNames.Count; i++)
                                {
                                    markerIdPath.Add(frameData.GetMarkerId(k_SampleNames[i]));
                                }
                                deepProfilingmarkerIdPath.AddRange(markerIdPath);
                                // GetMarkerId needs the full length marker name to be able to identify this sample.
                                markerIdPath.Add(frameData.GetMarkerId(GetUpdateSampleName(UpdateNameMatchType.Full, false)));
                                deepProfilingmarkerIdPath.Add(frameData.GetMarkerId(GetUpdateSampleName(UpdateNameMatchType.Full, true)));<br /><br />                                gcAllocMarkerId = frameData.GetMarkerId(k_GCAllocSampleName);
                            }<br /><br />                            if (cpuSampleSelectionController.SetSelection(m_Profiler.selectedFrameIndex,
                                k_MainThreadGroupName, k_MainThreadName, gcAllocMarkerId, markerIdPath) ||
                                cpuSampleSelectionController.SetSelection(m_Profiler.selectedFrameIndex,
                                    k_MainThreadGroupName, k_MainThreadName, gcAllocMarkerId, deepProfilingmarkerIdPath))
                            {
                                <a href="Debug.LogWarning.html">Debug.LogWarning</a>("MyScript allocates in its <a href="PlayerLoop.Update.html">Update</a> loop");
                            }
                            else
                            {
                                // MyScript did not have a GC.Alloc sample underneath it, but maybe a different <a href="PlayerLoop.Update.html">Update</a> sample allocated
                                // Remove the MyScript sample id from the path and search through all <a href="PlayerLoop.Update.html">Update</a>() samples
                                markerIdPath.Remove(markerIdPath.Count - 1);
                                if (cpuSampleSelectionController.SetSelection(m_Profiler.selectedFrameIndex,
                                    k_MainThreadGroupName, k_MainThreadName,
                                    gcAllocMarkerId, markerIdPath))
                                {
                                    <a href="Debug.LogWarning.html">Debug.LogWarning</a>($"MyScript does not allocate but {cpuSampleSelectionController.selection.markerNamePath[k_SampleNames.Count]} allocates in its <a href="PlayerLoop.Update.html">Update</a> loop");
                                    return;
                                }
                                <a href="Debug.Log.html">Debug.Log</a>("No Script is allocating in its <a href="PlayerLoop.Update.html">Update</a> Loop");
                                FindAnyGCAllocSample(cpuSampleSelectionController);
                            }
                        }
                    }
                }
            }
        }
    }<br /><br />    void FindAnyGCAllocSample(<a href="Profiling.IProfilerFrameTimeViewSampleSelectionController.html">IProfilerFrameTimeViewSampleSelectionController</a> cpuSampleSelectionController)
    {
        using (var frameData = ProfilerDriver.GetRawFrameDataView((int)m_Profiler.selectedFrameIndex, 0))
        {
            var gcAllocMarkerId = frameData.GetMarkerId(k_GCAllocSampleName);
            for (int i = 0; i &lt; frameData.sampleCount; i++)
            {
                if (frameData.GetSampleMarkerId(i) == gcAllocMarkerId)
                {
                    var selection = new <a href="Profiling.ProfilerTimeSampleSelection.html">ProfilerTimeSampleSelection</a>(m_Profiler.selectedFrameIndex, k_MainThreadGroupName,
                        k_MainThreadName, frameData.threadId, i);
                    if (cpuSampleSelectionController.SetSelection(selection))
                    {
                        // do not use the selection object here. The CPU <a href="Profiling.Profiler.html">Profiler</a> Module created a new one.
                        // Instead Get the selection object from the <a href="Profiling.Profiler.html">Profiler</a>
                        <a href="Debug.LogWarning.html">Debug.LogWarning</a>($"MyScript does not allocate but {cpuSampleSelectionController.selection.markerNamePath[k_SampleNames.Count]} allocates in its <a href="PlayerLoop.Update.html">Update</a> loop");
                        return;
                    }
                }
            }
            <a href="Debug.Log.html">Debug.Log</a>("No Script is allocating anything");
        }
    }
}
</pre>
      </div>
              <div class="subsection">
        <p>This example shows all major variations of SetSelection and showcases their differences.</p>
      </div>
            </div>
            <div class="section">
              <div id="_content">
              </div>
            </div>
            <div class="footer-wrapper">
              <div class="footer clear">
                <div class="copy">
                  <p>
                    <known_issues>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at </known_issues>
                    <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p>Copyright Â©2024 Unity Technologies. Publication Date: 2024-10-03.
                                        </div>
                <div class="menu">
                  <a href="https://unity3d.com/learn">Tutorials</a>
                  <a href="https://answers.unity3d.com">Community Answers</a>
                  <a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a>
                  <a href="https://forum.unity3d.com">Forums</a>
                  <a href="https://unity3d.com/asset-store">Asset Store</a>
                  <a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a>
                  <a href="https://unity.com/legal">Legal</a>
                  <a href="https://unity.com/legal/privacy-policy">Privacy Policy</a>
                  <a href="https://unity.com/legal/cookie-policy">Cookies</a>
                  <a href="https://unity.com/legal/do-not-sell-my-personal-information">Do Not Sell or Share My Personal Information</a>
                  <div id="ot-sdk-btn-container">
                    <a id="ot-sdk-btn" class="ot-sdk-show-settings" href="javascript:void(0);">Your Privacy Choices (Cookie Settings)</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>